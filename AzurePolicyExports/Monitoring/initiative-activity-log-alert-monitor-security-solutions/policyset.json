{
 "properties": {
  "displayName": "Activity Log Alert Monitor Security Solutions",
  "policyType": "Custom",
  "description": "Initiative to define Security Solution Alert rules for creation, updates or deletes\n\n          \"Microsoft.Security/policies/write\",\n          \"Microsoft.Security/securitySolutions/write\",\n          \"Microsoft.Security/securitySolutions/delete\"",
  "metadata": {
   "category": "Custom Policies"
  },
  "parameters": {
   "AlertRuleActionGroupName": {
    "type": "String",
    "metadata": {
     "displayName": "Action Group Name",
     "description": "Name for the Action group to use with the alert. It must be in the same resource group where the alert will be created."
    }
   },
   "RuleResourceGroupName": {
    "type": "String",
    "metadata": {
     "displayName": "Resource Group Name",
     "description": "This is the name of the Resource Group that will contain the Activity log alert resource and the action group for the alert.",
     "strongType": "existingResourceGroups"
    }
   },
   "RuleNameSecurityPolicyCreateModify": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Security Policy Create",
     "description": "Alert Name for Security Policy Creations"
    },
    "defaultValue": "Alert Monitor Security Policy Create or Update"
   },
   "RuleNameSecuritySolutionCreateModify": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Security Solution Create or Update",
     "description": "Alert name for Security Solution create or Update"
    },
    "defaultValue": "Alert Monitor Security Solution Create or Update"
   },
   "RuleNameSecuritySolutionDelete": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Security Solution Delete",
     "description": "Alert Name for security solution delete"
    },
    "defaultValue": "Alert Monitor Security Solution Delete"
   }
  },
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Security Policy Create or Update",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/9974ccae-7ba9-4c3e-a8d3-3686bf691e1e",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameSecurityPolicyCreateModify')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Security/policies/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Security Solution Create or Update",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/9974ccae-7ba9-4c3e-a8d3-3686bf691e1e",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameSecuritySolutionCreateModify')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Security/securitySolutions/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Security Solution Delete",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/9974ccae-7ba9-4c3e-a8d3-3686bf691e1e",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameSecuritySolutionDelete')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Security/securitySolutions/delete"
     }
    },
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policySetDefinitions/c6eb7a65c70542f385db0980",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "c6eb7a65c70542f385db0980"
}