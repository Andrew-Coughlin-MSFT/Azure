{
 "properties": {
  "displayName": "Activity Log Alert Monitor SQL Server Firewall Rules",
  "policyType": "Custom",
  "description": "Initiative to define Firewall Rule Alert for:\n\n          \"Microsoft.Sql/servers/firewallRules/write\",\n          \"Microsoft.Sql/servers/firewallRules/delete\"",
  "metadata": {
   "category": "Custom Policies"
  },
  "parameters": {
   "AlertRuleActionGroupName": {
    "type": "String",
    "metadata": {
     "displayName": "Action Group Name",
     "description": "Name for the Action group to use with the alert. It must be in the same resource group where the alert will be created."
    }
   },
   "RuleResourceGroupName": {
    "type": "String",
    "metadata": {
     "displayName": "Resource Group Name",
     "description": "This is the name of the Resource Group that will contain the Activity log alert resource and the action group for the alert.",
     "strongType": "existingResourceGroups"
    }
   },
   "RuleNameFirewallRules": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Firewall SQL Server Rule Name for Create and Update",
     "description": "Name of the Alert for Firewall rules"
    },
    "defaultValue": "Alert Monitor SQL Server Firewall Rule Create or Update"
   },
   "RuleNameFirewallRulesDelete": {
    "type": "String",
    "metadata": {
     "displayName": "Alert SQL Server Firewall Rule Name for Delete",
     "description": "Alert Monitor name for Firewall Rule Name for delete"
    },
    "defaultValue": "Alert Monitor SQL Server Firewall Rule Delete"
   }
  },
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor SQL Server Firewall Rules for Create and Update",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/17da6819-7209-436f-a36e-5cd4b2ce8320",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameFirewallRules')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Sql/servers/firewallRules/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor SQL Server Firewall Rules for Delete",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/17da6819-7209-436f-a36e-5cd4b2ce8320",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameFirewallRulesDelete')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Sql/servers/firewallRules/delete"
     }
    },
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policySetDefinitions/34bbdc12f4254789af9fdabd",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "34bbdc12f4254789af9fdabd"
}