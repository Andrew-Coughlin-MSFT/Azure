{
 "properties": {
  "displayName": "Activity Log Alert Monitor Network Security Group Rules",
  "policyType": "Custom",
  "description": "Initiative to define Network Security Group Alert rules for creation or updates.\n\n          \"Microsoft.Network/networkSecurityGroups/write\",\n          \"Microsoft.ClassicNetwork/networkSecurityGroups/write\",\n          \"Microsoft.Network/networkSecurityGroups/delete\",\n          \"Microsoft.ClassicNetwork/networkSecurityGroups/delete\"",
  "metadata": {
   "category": "Custom Policies",
   "version": "1.0",
   "createdBy": "20857a0c-5f1e-4ad9-b3d3-205ddb8b8799",
   "createdOn": "2021-02-28T19:49:05.7876347Z",
   "updatedBy": "20857a0c-5f1e-4ad9-b3d3-205ddb8b8799",
   "updatedOn": "2021-03-01T02:39:14.4566454Z"
  },
  "parameters": {
   "AlertRuleActionGroupName": {
    "type": "String",
    "metadata": {
     "displayName": "Action Group Name",
     "description": "Name of the action group to use with this alert."
    }
   },
   "RuleResourceGroupName": {
    "type": "String",
    "metadata": {
     "displayName": "Resource Group Name",
     "description": "Name of the Resource Group that will contain the rule.",
     "strongType": "existingResourceGroups"
    }
   },
   "RuleNameNetworkSecurityGroup": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Network Security Group Name",
     "description": "Name of the alert for Network Security Group"
    },
    "defaultValue": "Alert Monitor Network Security Group Rules Create or Modify"
   },
   "RuleNameClassicNetworkSecurityGroup": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Classic Network Security Group Name",
     "description": "Name of the classic network security group alert."
    },
    "defaultValue": "Alert Monitor Classic Network Security Group Rules Create or Modify"
   },
   "RuleNameNetworkSecurityGroupDelete": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Network Security Group Delete Name",
     "description": "Alert name for Network Security Group Delete Name"
    },
    "defaultValue": "Alert Monitor Network Security Group Rules Delete"
   },
   "RuleNameClassicNetworkSecurityGroupDelete": {
    "type": "String",
    "metadata": {
     "displayName": "Alert Classic Network Security Group Delete",
     "description": "Name of the alert for Classic Network Security Group Delete"
    },
    "defaultValue": "Alert Monitor Classic Network Security Group Rules Delete"
   }
  },
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Network Security Groups Rules Create and Update",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/cb5c9d3c-11c7-47bb-84c8-9d2734e5070f",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameNetworkSecurityGroup')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Network/networkSecurityGroups/securityRules/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Classic Network Security Groups Rules Create and Update",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/cb5c9d3c-11c7-47bb-84c8-9d2734e5070f",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameClassicNetworkSecurityGroup')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.ClassicNetwork/networkSecurityGroups/securityRules/write"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Network Security Groups Rules Delete",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/cb5c9d3c-11c7-47bb-84c8-9d2734e5070f",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameNetworkSecurityGroupDelete')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.Network/networkSecurityGroups/securityRules/delete"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity Log Alert Monitor Classic Network Security Groups Rules Delete",
    "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policyDefinitions/cb5c9d3c-11c7-47bb-84c8-9d2734e5070f",
    "parameters": {
     "actionGroupName": {
      "value": "[parameters('AlertRuleActionGroupName')]"
     },
     "activityLogAlertName": {
      "value": "[parameters('RuleNameClassicNetworkSecurityGroupDelete')]"
     },
     "ActivityLogAlertResourceGroupName": {
      "value": "[parameters('RuleResourceGroupName')]"
     },
     "operationName": {
      "value": "Microsoft.ClassicNetwork/networkSecurityGroups/securityRules/delete"
     }
    },
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/providers/Microsoft.Management/managementGroups/78dd488d-892f-4724-9861-9486288f62b8/providers/Microsoft.Authorization/policySetDefinitions/a2d751f53726428587b6bbfb",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "a2d751f53726428587b6bbfb"
}