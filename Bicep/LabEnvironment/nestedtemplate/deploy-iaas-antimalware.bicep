@description('Location for all resources.')
param location string

@description('Scanning Type')
@allowed([
  'Full'
  'Quick'
])
param scantype string

@description('Variable for the virtual machine that we will need.')
param vm string

resource vm_IaaSAntimalware 'Microsoft.Compute/virtualMachines/extensions@2022-03-01' = {
  name:'${vm}/IaaSAntimalware'
  location: location
  properties: {
    autoUpgradeMinorVersion: true
    publisher: 'Microsoft.Azure.Security'
    type: 'IaaSAntimalware'
    typeHandlerVersion: '1.3'
    settings: {
      AntimalwareEnabled: true
      RealtimeProtectionEnabled: 'true'
      ScheduledScanSettings: {
        isEnabled: 'true'
        day: '7'
        time: '120'
        scanType: scantype
      }
    }
  }
}
